(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[562],{422:(e,t,s)=>{"use strict";s.d(t,{wE:()=>b,A3:()=>g,GH:()=>f,Df:()=>p,Dq:()=>E,gg:()=>m,FD:()=>x,BC:()=>h});var a=s(7058),l=s(1417),r=s(1423);async function n(e){var t,s,a;let r=await (0,l.parseStringPromise)(e,{explicitArray:!1}),n=null==r||null==(a=r.ENVELOPE)||null==(s=a.BODY)||null==(t=s.DATA)?void 0:t.COLLECTION;if(!n)throw Error("Cannot find COLLECTION element");return(Array.isArray(n.LEDGER)?n.LEDGER:[n.LEDGER]).map(e=>e.$.NAME)}async function i(e){return await (0,a.AT)("","POST",e,{},"application/xml","text")}function o(e){let t=e.match(/<CREATED>(\d+)<\/CREATED>/),s=e.match(/<EXCEPTIONS>(\d+)<\/EXCEPTIONS>/);return{created:t?parseInt(t[1],10):0,exceptions:s?parseInt(s[1],10):0}}let c=["cgst0%","cgst2.5%","cgst6%","cgst9%","cgst14%","igst0%","igst5%","igst12%","igst18%","igst28%","ut/sgst0%","ut/sgst2.5%","ut/sgst6%","ut/sgst9%","ut/sgst14%"];async function d(e){let t="<ENVELOPE>\n  <HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER>\n  <BODY><IMPORTDATA><REQUESTDESC><REPORTNAME>All Masters</REPORTNAME></REQUESTDESC>\n  <REQUESTDATA>";for(let s of e){let e=s.toLowerCase().startsWith("igst")?"IGST":"CGST";t+='<TALLYMESSAGE xmlns:UDF="TallyUDF">\n    <LEDGER Action="Create">\n      <NAME>'.concat(s,"</NAME>\n      <PARENT>Duties &amp; Taxes</PARENT>\n      <TAXTYPE>").concat(e,"</TAXTYPE>\n    </LEDGER>\n</TALLYMESSAGE>")}t+="</REQUESTDATA></IMPORTDATA></BODY></ENVELOPE>";try{let e=await i(t);return{success:!0,data:e}}catch(e){return{success:!1,data:""}}}async function u(e){var t,s,a,r,n,i;let o=await (0,l.parseStringPromise)(e,{explicitArray:!1}),c=null==o||null==(a=o.ENVELOPE)||null==(s=a.BODY)||null==(t=s.DATA)?void 0:t.COLLECTION;if(!c)return[];let d=Array.isArray(c.LEDGER)?c.LEDGER:[c.LEDGER],u=new Set,m=[];for(let e of d){let t=(null==(r=e.$)?void 0:r.NAME)||"",s=(null==(i=e["LEDGSTREGDETAILS.LIST"])||null==(n=i.GSTIN)?void 0:n.trim())||"";s&&!u.has(s)&&(u.add(s),m.push({name:t,gst:s}))}return m}async function m(e){var t,s,a,r,n,o;let c=await i(e),d=await (0,l.parseStringPromise)(c,{explicitArray:!1}),u=(null==d||null==(r=d.ENVELOPE)||null==(a=r.BODY)||null==(s=a.DATA)||null==(t=s.COLLECTION)?void 0:t.COMPANY)||[];return{success:!0,data:Array.isArray(u)?u.map(e=>{var t,s;return(null==(t=e.NAME)?void 0:t._)||(null==(s=e.$)?void 0:s.NAME)}):[(null==(n=u.NAME)?void 0:n._)||(null==(o=u.$)?void 0:o.NAME)]}}async function x(e){let t=await i(e);return await u(t)}async function h(e){let t=await i(e),s=await n(t),a=c.filter(e=>!s.includes(e));if(a.length){let e=o((await d(a)).data);return{success:e.created===a.length,data:e,ledgerName:a}}return{success:!0,data:{},ledgerName:s}}async function g(e,t,s){let a=await i(e),l=await n(a);if(!l.includes(t)){let e='<ENVELOPE>\n      <HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER>\n      <BODY><IMPORTDATA><REQUESTDESC><REPORTNAME>All Masters</REPORTNAME></REQUESTDESC>\n      <REQUESTDATA>\n        <TALLYMESSAGE xmlns:UDF="TallyUDF">\n          <LEDGER Action="Create">\n            <NAME>'.concat(s.name,"</NAME>\n            <PARENT>").concat(s.parent,"</PARENT>\n            ").concat(s.date&&s.gstin?"<LEDGSTREGDETAILS.LIST>\n              <APPLICABLEFROM>".concat(s.date,"</APPLICABLEFROM>\n              <GSTREGISTRATIONTYPE>Regular</GSTREGISTRATIONTYPE>\n              <GSTIN>").concat(s.gstin,"</GSTIN>\n            </LEDGSTREGDETAILS.LIST>\n            <LEDMAILINGDETAILS.LIST>\n              <APPLICABLEFROM>").concat(s.date,"</APPLICABLEFROM>\n              <STATE>").concat(s.state,"</STATE>\n              <COUNTRY>").concat(s.country,"</COUNTRY>\n            </LEDMAILINGDETAILS.LIST>"):"","\n          </LEDGER>\n        </TALLYMESSAGE>\n      </REQUESTDATA></IMPORTDATA></BODY></ENVELOPE>");return{success:!0,data:o(await i(e)),ledgerName:await n(a)}}return{success:!0,isExist:!0,data:l}}async function p(e,t){let s=await i(e);if(!(await n(s)).includes(t)){let e=function(e){if(!e)throw Error("Purchase name is required");return'<ENVELOPE>\n  <HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER>\n  <BODY>\n    <IMPORTDATA>\n      <REQUESTDESC><REPORTNAME>All Masters</REPORTNAME></REQUESTDESC>\n      <REQUESTDATA>\n        <TALLYMESSAGE>\n          <LEDGER NAME="'.concat(e,'" Action="Create">\n            <NAME>').concat(e,"</NAME>\n            <PARENT>Purchase Accounts</PARENT>\n            <APPROPRIATEFOR>GST</APPROPRIATEFOR>\n            <GSTAPPROPRIATETO>Goods and Services</GSTAPPROPRIATETO>\n          </LEDGER>\n        </TALLYMESSAGE>\n      </REQUESTDATA>\n    </IMPORTDATA>\n  </BODY>\n</ENVELOPE>")}(t);return{success:1===o(await (0,a.AT)("","POST",e,{},"application/xml","text")).created,data:t}}return{success:!0,isExist:!0,data:t}}async function E(e){let t=await i('<ENVELOPE>\n    <HEADER><TALLYREQUEST>Export</TALLYREQUEST><TYPE>Collection</TYPE><ID>Custom List of Units</ID></HEADER>\n    <BODY><DESC><TDL><TDLMESSAGE>\n      <COLLECTION NAME="Custom List of Units"><TYPE>Units</TYPE><NATIVEMETHOD>MasterID</NATIVEMETHOD><NATIVEMETHOD>GUID</NATIVEMETHOD></COLLECTION>\n    </TDLMESSAGE></TDL></DESC></BODY>\n</ENVELOPE>'),s=await n(t),a=e.filter(e=>!s.includes(e.name));if(a.length){let t=function(e){let t=e.map((e,t)=>{let s="bf911d27-633e-4ad7-ba7c-a871d6f9461e-".concat((263+t).toString().padStart(8,"0"));return'<TALLYMESSAGE xmlns:UDF="TallyUDF">\n  <UNIT NAME="'.concat(e.name,'" RESERVEDNAME="">\n    <NAME>').concat(e.name,"</NAME>\n    <GUID>").concat(s,"</GUID>\n    <ALTERID>").concat(1005+t,"</ALTERID>\n    <DECIMALPLACES>").concat(e.decimal,"</DECIMALPLACES>\n  </UNIT>\n</TALLYMESSAGE>")});return"<ENVELOPE>\n  <HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER>\n  <BODY>\n    <IMPORTDATA>\n      <REQUESTDESC><REPORTNAME>All Masters</REPORTNAME></REQUESTDESC>\n      <REQUESTDATA>\n        ".concat(t.join("\n"),"\n      </REQUESTDATA>\n    </IMPORTDATA>\n  </BODY>\n</ENVELOPE>")}(a);return{success:o(await i(t)).created===a.length,data:e}}return{success:!0,isExist:[],data:e}}async function b(e){let t=await i('<ENVELOPE>\n    <HEADER><TALLYREQUEST>Export</TALLYREQUEST><TYPE>Collection</TYPE><ID>Custom List of StockItems</ID></HEADER>\n    <BODY><DESC><TDL><TDLMESSAGE>\n      <COLLECTION NAME="Custom List of StockItems"><TYPE>StockItem</TYPE><NATIVEMETHOD>MasterID</NATIVEMETHOD><NATIVEMETHOD>GUID</NATIVEMETHOD></COLLECTION>\n    </TDLMESSAGE></TDL></DESC></BODY>\n</ENVELOPE>'),s=await n(t),a=e.filter(e=>!s.includes(e.Product));if(a.length){let t=function(e){let t=e.map((e,t)=>{let s="bf911d27-633e-4ad7-ba7c-a871d6f9461e-".concat((269+t).toString().padStart(8,"0"));return'<TALLYMESSAGE xmlns:UDF="TallyUDF">\n  <STOCKITEM NAME="'.concat(e.Product,'" RESERVEDNAME="">\n    <GUID>').concat(s,"</GUID>\n    <ALTERID>").concat(1011+t,"</ALTERID>\n    <BASEUNITS>").concat(e.symbol,"</BASEUNITS>\n  </STOCKITEM>\n</TALLYMESSAGE>")});return"<ENVELOPE>\n  <HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER>\n  <BODY>\n    <IMPORTDATA>\n      <REQUESTDESC><REPORTNAME>All Masters</REPORTNAME></REQUESTDESC>\n      <REQUESTDATA>\n        ".concat(t.join("\n"),"\n      </REQUESTDATA>\n    </IMPORTDATA>\n  </BODY>\n</ENVELOPE>")}(a);return{success:o(await i(t)).created===a.length,data:e}}return{success:!0,isExist:[],data:e}}async function f(e){let t=function(e){let t=(0,r.A)(),s="".concat((0,r.A)(),":00001"),a=e.items.map(e=>"<ALLINVENTORYENTRIES.LIST>\n  <STOCKITEMNAME>".concat(e.name,"</STOCKITEMNAME>\n  <RATE>").concat(e.price,"</RATE>\n  <AMOUNT>-").concat(e.price*e.quantity,"</AMOUNT>\n  <ACTUALQTY>").concat(e.quantity," ").concat(e.unit,"</ACTUALQTY>\n</ALLINVENTORYENTRIES.LIST>")).join("");return'<ENVELOPE>\n  <HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER>\n  <BODY>\n    <IMPORTDATA>\n      <REQUESTDESC><REPORTNAME>All Masters</REPORTNAME></REQUESTDESC>\n      <REQUESTDATA>\n        <TALLYMESSAGE xmlns:UDF="TallyUDF">\n          <VOUCHER REMOTEID="'.concat(t,'" VCHKEY="').concat(s,'" VCHTYPE="Purchase" ACTION="Create">\n            <DATE>').concat(e.invoiceDate,"</DATE>\n            <PARTYLEDGERNAME>").concat(e.partyName,"</PARTYLEDGERNAME>\n            <VOUCHERNUMBER>").concat(e.invoiceNumber,"</VOUCHERNUMBER>\n            ").concat(a,"\n          </VOUCHER>\n        </TALLYMESSAGE>\n      </REQUESTDATA>\n    </IMPORTDATA>\n  </BODY>\n</ENVELOPE>")}(e),s=await i(t);return{success:o(s).created>0,data:s}}},2383:()=>{},3686:()=>{},5681:(e,t,s)=>{"use strict";s.r(t),s.d(t,{LoadingScreen:()=>X,RowDetailModal:()=>H,default:()=>q,extractCompanyNames:()=>Q});var a=s(7876),l=s(4232),r=s(1040),n=s(7058),i=s(9099),o=s(422),c=s(672),d=s(4589),u=s(5104),m=s(1383),x=s(895),h=s(2963),g=s(6257),p=s(498),E=s(6739),b=s(4822),f=s(1815),N=s(5390),y=s(2089),T=s(6108),j=s(2885),v=s(5454),A=s(3654),w=s(9976),S=s(1758),D=s(5167),I=s(1964),R=s(3022),L=s(4301),C=s(5290),P=s(5961),O=s(5682),M=s(4296),k=s(470),G=s(9744),Y=s(1417),U=s(2746),F=s(2770);let V=e=>Number(e||0).toFixed(2),B=e=>parseFloat(e)||0,H=e=>{let{open:t,onClose:s,item:r,rowIndex:n,onUpdate:i,images:o}=e;return((0,l.useEffect)(()=>{if(!t)return;let e=e=>"Escape"===e.key&&s();return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,s]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:s,children:(0,a.jsxs)("div",{className:"relative w-full max-w-5xl mx-4 rounded-2xl bg-white shadow-xl p-8",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",children:(0,a.jsx)(c.A,{className:"w-6 h-6"})}),(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-6",children:["Row\xa0",n+1," — detailed view"]}),(0,a.jsx)("div",{className:"grid lg:grid-cols-8 sm:grid-cols-2 gap-4 mb-8",children:[["Product","Product"],["QTY","QTY"],["HSN","HSN"],["MRP","MRP"],["RATE","RATE"],["DIS","DIS"],["SGST","SGST"],["CGST","CGST"]].map(e=>{var t;let[s,l]=e;return(0,a.jsxs)("label",{className:"text-sm font-medium text-gray-600",children:[s,(0,a.jsx)("input",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 p-2",type:"Product"===l?"text":"number",value:null!=(t=r[l])?t:"",onChange:e=>i(l,e.target.value)})]},l)})}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 justify-center",children:[0===o.length&&(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No images for this row"}),o.map((e,t)=>(0,a.jsx)("img",{src:e,alt:"cell ".concat(n,"-").concat(t),className:"border rounded-lg object-contain w-[100px] h-[120px]"},t))]})]})}):null};async function Q(e){let t=(await (0,Y.parseStringPromise)(e,{explicitArray:!1})).ENVELOPE.BODY.DATA.COLLECTION.COMPANY;return t?(Array.isArray(t)||(t=[t]),t.map(e=>{let t=e.NAME;return t&&"object"==typeof t&&"_"in t?t._:t})):[]}let z=e=>{let{src:t,alt:s,style:r}=e,[n,i]=(0,l.useState)(1),[o,c]=(0,l.useState)({x:0,y:0}),[m,x]=(0,l.useState)(!1),[h,g]=(0,l.useState)({x:0,y:0}),[p,E]=(0,l.useState)(!0),[b,f]=(0,l.useState)(!1),N=(0,l.useRef)(null),y=(0,l.useRef)(null),T=e=>{let t=Math.max(1,Math.min(5,n+e));if(t===n||!N.current||!y.current)return;let s=N.current.getBoundingClientRect(),a=s.width,l=s.height,r=a/2,d=l/2;if(t>n){let e=t/n;c({x:(o.x-r)*e+r,y:(o.y-d)*e+d})}else{let e=t/n,s=o.x*e,a=o.y*e;1===t?c({x:0,y:0}):c({x:s,y:a})}if(i(t),!p&&!b){f(!0);let e=setTimeout(()=>f(!1),2e3);return()=>clearTimeout(e)}},j=()=>{x(!1),N.current&&(N.current.style.cursor=n>1?"grab":"default")};return(0,a.jsxs)("div",{ref:N,className:"relative overflow-hidden rounded-xl bg-gray-50",style:{...r,cursor:m?"grabbing":n>1?"grab":"default",userSelect:"none"},onWheel:e=>{e.preventDefault(),T(-.003*e.deltaY)},onMouseDown:e=>{n>1&&(x(!0),g({x:e.clientX-o.x,y:e.clientY-o.y}),N.current&&(N.current.style.cursor="grabbing"))},onMouseMove:e=>{m&&c({x:e.clientX-h.x,y:e.clientY-h.y})},onMouseUp:j,onMouseLeave:j,onDoubleClick:e=>{if(n>1)i(1),c({x:0,y:0});else{if(!N.current)return;let t=N.current.getBoundingClientRect(),s=e.clientX-t.left,a=e.clientY-t.top,l=t.width/2,r=t.height/2;i(2),c({x:(l-s)*2,y:(r-a)*2})}},children:[(0,a.jsx)("img",{ref:y,src:t,alt:s,style:{transform:"translate(".concat(o.x,"px, ").concat(o.y,"px) scale(").concat(n,")"),transformOrigin:"center",transition:m?"none":"transform 0.2s ease-out",width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}),(0,a.jsxs)("div",{className:"absolute bottom-3 right-3 bg-black/70 text-white text-xs px-3 py-1.5 rounded-full flex items-center gap-1.5 backdrop-blur-sm shadow-sm",children:[(0,a.jsx)(d.A,{className:"w-3.5 h-3.5"}),Math.round(100*n),"%"]}),(0,a.jsx)("div",{className:"absolute top-3 right-3 transition-opacity opacity-80 hover:opacity-100",children:(0,a.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm p-1.5 rounded-lg shadow-lg flex gap-1 border border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>T(-.25),className:"p-1.5 rounded-md hover:bg-gray-100 text-gray-700 transition-colors",title:"Zoom out",disabled:n<=1,children:(0,a.jsx)(C.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>T(.25),className:"p-1.5 rounded-md hover:bg-gray-100 text-gray-700 transition-colors",title:"Zoom in",disabled:n>=5,children:(0,a.jsx)(d.A,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"w-px h-6 my-auto bg-gray-200 mx-0.5"}),(0,a.jsx)("button",{onClick:()=>{i(1),c({x:0,y:0}),f(!0),setTimeout(()=>f(!1),2e3)},className:"p-1.5 rounded-md hover:bg-gray-100 text-gray-700 transition-colors",title:"Reset view",children:(0,a.jsx)(P.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{N.current&&(document.fullscreenElement?document.exitFullscreen():N.current.requestFullscreen())},className:"p-1.5 rounded-md hover:bg-gray-100 text-gray-700 transition-colors",title:"Toggle fullscreen",children:(0,a.jsx)(O.A,{className:"w-4 h-4"})})]})}),(0,a.jsx)("div",{className:"md:hidden absolute bottom-12 left-1/2 transform -translate-x-1/2 transition-opacity opacity-80 hover:opacity-100",children:(0,a.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm p-1.5 rounded-full shadow-lg flex gap-1 border border-gray-200",children:[(0,a.jsx)("button",{onClick:()=>T(-.25),className:"p-2 rounded-full hover:bg-gray-100 text-gray-700",disabled:n<=1,children:(0,a.jsx)(M.A,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>T(.25),className:"p-2 rounded-full hover:bg-gray-100 text-gray-700",disabled:n>=5,children:(0,a.jsx)(u.A,{className:"w-5 h-5"})})]})}),b&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center transition-opacity",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl p-5 max-w-md shadow-xl",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Image Controls"}),(0,a.jsxs)("ul",{className:"space-y-3",children:[(0,a.jsxs)("li",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 rounded-full p-1.5",children:(0,a.jsx)(k.A,{className:"w-5 h-5 text-blue-700"})}),(0,a.jsx)("span",{className:"text-gray-600",children:"Drag to pan when zoomed in"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 rounded-full p-1.5",children:(0,a.jsx)(d.A,{className:"w-5 h-5 text-blue-700"})}),(0,a.jsx)("span",{className:"text-gray-600",children:"Scroll to zoom in/out"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 rounded-full p-1.5",children:(0,a.jsx)(O.A,{className:"w-5 h-5 text-blue-700"})}),(0,a.jsx)("span",{className:"text-gray-600",children:"Double-click to toggle zoom"})]})]}),(0,a.jsx)("button",{className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg w-full hover:bg-blue-700 transition-colors",onClick:()=>f(!1),children:"Got it"})]})}),n>1&&!b&&(0,a.jsxs)("div",{className:"absolute bottom-12 left-3 bg-black/40 text-white text-xs px-2.5 py-1 rounded-full flex items-center gap-1 backdrop-blur-sm opacity-80",children:[(0,a.jsx)(k.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Drag to pan"})]})]})};function X(e){let{isLoading:t}=e,s=["Extracting Necessary Data...","Processing Image with AI Model...","Converting Data into Text...","Finalizing Results..."],[r,n]=(0,l.useState)(0),[o,c]=(0,l.useState)(0);return((0,i.useRouter)(),(0,l.useEffect)(()=>{let e=setInterval(()=>{n(e=>(e+1)%s.length)},2e3);return()=>clearInterval(e)},[s.length]),(0,l.useEffect)(()=>{if(t){let e=Date.now(),t=setInterval(()=>{c(Date.now()-e)},1e3);return()=>clearInterval(t)}},[t]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/75 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-6 p-8 bg-white rounded-2xl shadow-xl max-w-md w-full mx-4",children:[(0,a.jsxs)("div",{className:"relative w-24 h-24 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 w-full h-full border-4 border-t-transparent border-blue-500/20 rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute inset-0 w-full h-full border-4 border-t-transparent border-l-transparent border-r-blue-500 border-b-blue-500 rounded-full animate-spin",style:{animationDuration:"1.5s"}}),(0,a.jsx)(m.A,{className:"w-10 h-10 text-blue-600"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-center",children:[(0,a.jsx)("p",{className:"text-xl font-semibold text-gray-800",children:s[r]}),(0,a.jsxs)("div",{className:"text-gray-500 font-medium flex items-center gap-2 justify-center",children:[(0,a.jsxs)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"2",stroke:"#CBD5E0"}),(0,a.jsx)("path",{strokeLinecap:"round",d:"M12 6v6l4 2",strokeWidth:"2",stroke:"currentColor"})]}),function(e){let t=Math.floor(e/1e3),s=String(Math.floor(t/3600)).padStart(2,"0"),a=String(Math.floor(t%3600/60)).padStart(2,"0"),l=String(t%60).padStart(2,"0");return"".concat(s,":").concat(a,":").concat(l)}(o)]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-100 h-2 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-blue-500 rounded-full animate-pulse",style:{width:"".concat((r+1)*25,"%")}})})]})}):null}let _=e=>{let{steps:t,currentStep:s}=e;return(0,a.jsx)("div",{className:"w-full max-w-4xl mx-auto mb-10",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:t.map((e,t)=>(0,a.jsx)("div",{className:"flex-1 relative",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-10 h-10 rounded-full text-sm font-medium transition-all duration-200 ".concat(s>=t?"bg-blue-600 text-white shadow-lg shadow-blue-200":"bg-gray-200 text-gray-500"),children:s>t?(0,a.jsx)(x.A,{className:"w-5 h-5"}):t+1}),(0,a.jsxs)("div",{className:"mt-2 text-center ".concat(s>=t?"text-gray-800 font-medium":"text-gray-400"),children:[(0,a.jsx)("span",{className:"hidden md:block",children:e}),(0,a.jsx)("span",{className:"md:hidden",children:e.split(" ")[0]})]})]})},e))})})},Z=e=>{let{label:t,value:s,onChange:l,style:r={}}=e;return(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:t}),(0,a.jsx)("input",{type:"text",value:s||"",onChange:l,className:"block w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all bg-white hover:bg-gray-50 focus:bg-white",style:r})]})};function q(){var e,t,s,i,d,x,C,P,O,M,k,Y,Q,q,J,W,$;let[K,ee]=(0,l.useState)(null),[et,es]=(0,l.useState)(0),[ea,el]=(0,l.useState)(""),[er,en]=(0,l.useState)([]),[ei,eo]=(0,l.useState)([]),[ec,ed]=(0,l.useState)(0),eu=(0,l.useRef)(null),[em,ex]=(0,l.useState)(!1),[eh,eg]=(0,l.useState)(!1),[ep,eE]=(0,l.useState)("Ready to export"),[eb,ef]=(0,l.useState)(null),[eN,ey]=(0,l.useState)(0),[eT,ej]=(0,l.useState)({}),[ev,eA]=(0,l.useState)(["Prime Depth Labs","Test 1","Test 2"]),[ew,eS]=(0,l.useState)(!1),[eD,eI]=(0,l.useState)(""),[eR,eL]=(0,l.useState)("07BGUPD3647XXXX"),[eC,eP]=(0,l.useState)(null),[eO,eM]=(0,l.useState)(null),[ek,eG]=(0,l.useState)(!1),[eY,eU]=(0,l.useState)([]),[eF,eV]=(0,l.useState)(0),eB=["image/jpeg","image/png","application/pdf"];(0,l.useEffect)(()=>()=>er.forEach(e=>URL.revokeObjectURL(e.dataUrl)),[er]);let eH=e=>new Promise((t,s)=>{let a=new FileReader;a.onload=()=>t(a.result),a.onerror=e=>s(e),a.readAsDataURL(e)}),eQ=async e=>{let t=e.filter(e=>eB.includes(e.type)&&e.size<=0x3200000);if(0===t.length)return void L.oR.error("Please upload valid files (JPEG, PNG, PDF) under ".concat(50,"MB"));let s=await Promise.all(t.map(async e=>({id:Math.random().toString(36).substr(2,9),name:e.name,dataUrl:await eH(e),file:e})));en(e=>[...e,...s])},ez=async e=>{eQ(Array.from(e.target.files||[]))},eX=async e=>{e.preventDefault(),ex(!1),eQ(Array.from(e.dataTransfer.files))},e_=async e=>{try{let{data:t,error:s}=await G.N.from("users").select("*").eq("email",e);if(s)throw s;return t}catch(e){return console.error("Error fetching user data:",e),null}};(0,l.useEffect)(()=>{let{data:e}=G.N.auth.onAuthStateChange((e,t)=>{var s,a;let l=null==t||null==(a=t.user)||null==(s=a.user_metadata)?void 0:s.email;l&&(async()=>{await e_(l)})()})},[]);let eZ=async()=>{eg(!0);try{let a=[...er];for(let e of eY){let t=await fetch(e.url),s=await t.blob(),l=await new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(s)});a.push({id:Math.random().toString(36).substr(2,9),name:e.key.split("/").pop(),dataUrl:l,file:new File([s],e.key.split("/").pop(),{type:s.type}),isMobile:!0})}{var e,t,s;let l=null!=eD?eD:"UNNAMED_COMPANY",r=new Date,n=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()],i=String(r.getDate()),o=JSON.parse(localStorage.getItem("BILLS")||"{}");o[l]=null!=(e=o[l])?e:{},o[l][n]=null!=(t=o[l][n])?t:{},o[l][n][i]=null!=(s=o[l][n][i])?s:[],a.map(e=>e.dataUrl).filter(Boolean).forEach(e=>{o[l][n][i].some(t=>t.imageUrl===e)||o[l][n][i].push({imageUrl:e})}),localStorage.setItem("BILLS",JSON.stringify(o))}for(let e of eY){let t=await fetch(e.url),s=await t.blob(),l=await new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(s)}),r={id:Math.random().toString(36).substr(2,9),name:e.key.split("/").pop(),dataUrl:l,file:new File([s],e.key.split("/").pop(),{type:s.type}),isMobile:!0};a.push(r)}en(a),eU([]);let l=a.map(async e=>{let t=new FormData;return t.append("file",e.file),t.append("user_id","2"),(await r.A.post("".concat(n.$o,"/extract-bill-details/"),t,{headers:{"Content-Type":"multipart/form-data"}})).data}),i=await Promise.all(l);eo(i),es(2)}catch(e){console.error("Error extracting bill details:",e),L.oR.error("Error extracting bill details. Please try again.")}finally{eg(!1)}},eq=(e,t)=>{let s=[...ei];s[ec]={...s[ec],[e]:t},eo(s)},eJ=(e,t,s,a)=>{let l=[...ei],r=[...l[e].items];if(r[t]={...r[t],[s]:a},["QTY","RATE","DIS","SGST","CGST"].includes(s)){let e=r[t],s=B(e.QTY)*B(e.RATE);r[t]["G AMT"]=V(s),r[t]["NET AMT"]=V(s)}l[e].items=r,eo(l),ts(e,l)},eW=e=>{let t=[...ei];t[e].items||(t[e].items=[]),t[e].items.push({Product:"",QTY:"",FREE:"",HSN:"",MRP:"",RATE:"",DIS:"","G AMT":"",SGST:"",CGST:"","NET AMT":"",UNIT:"PCS"}),eo(t)},e$=(e,t)=>{let s=[...ei];s[e].items.splice(t,1),eo(s),ts(e,t,"","")},eK=(e,t,s)=>{e.dataTransfer.setData("text/plain",s.toString())},e0=e=>{e.preventDefault()},e2=(e,t,s)=>{e.preventDefault();let a=Number(e.dataTransfer.getData("text/plain"));if(a===s)return;let l=[...ei],r=l[t].items,n=r[a].Product;r[a].Product=r[s].Product,r[s].Product=n,l[t].items=r,eo(l)},e1=async e=>{let t=er.findIndex(t=>t.id===e);en(t=>t.filter(t=>t.id!==e)),eo(e=>e.filter((e,s)=>s!==t))},e5=e=>{var t,s;if(ed(e),ei.length>0&&(null==(s=ei[e])||null==(t=s.items)?void 0:t.length)>0){let t=ei[e].items.reduce((e,t)=>e+parseFloat(t.RATE)*parseFloat(t.QTY),0),s={};ei[e].items.forEach(e=>{let t=(parseFloat(e.SGST)||0)+(parseFloat(e.CGST)||0),a=parseFloat(e.RATE)*parseFloat(e.QTY);if(console.log({gstRate:t,gAmount:a}),t>0){let e="".concat(t,"%");s[e]||(s[e]=0),s[e]+=a*t/100}}),ey(t),ej(s)}else ey(0),ej({})};function e6(e){let t;if(e instanceof Date)t=e;else if(null==e?void 0:e.includes("/")){let s=e.split("/");if(3===s.length){let e,a,[l,r,n]=s,i=parseInt(l,10),o=parseInt(r,10),c=parseInt(n,10);i>12?(e=i,a=o):o>12?(a=i,e=o):(e=i,a=o),t=new Date(c,a-1,e)}else t=new Date(e)}else t=new Date(e);let s=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getFullYear();return"".concat(s,"-").concat(a,"-").concat(l)}function e4(e){let t=new Set,s=[];for(let l of e){var a;if(t.has(l.Product))continue;t.add(l.Product);let e=(parseFloat(l.SGST)||0)+(parseFloat(l.CGST)||0),r=l.Product.replace(/['"]/g,""),n=(null==(a=l.UNIT)?void 0:a.replace(/\d+/g,"").trim())||"PCS";s.push({Product:r,HSN:l.HSN,SGST:l.SGST,CGST:l.CGST,gst:e,decimal:e/100,symbol:n})}return s}function e3(e){return e.map(e=>{var t;let s=e.Product.replace(/['"]/g,""),a=(null==(t=e.UNIT)?void 0:t.replace(/\d+/g,"").trim())||"PCS";return{name:s,price:0===e.RATE?1:e.RATE,quantity:0===e.QTY?1:e.QTY,unit:a}})}function e8(e){let t=[];return e.forEach(e=>{var s;let a=(null==e||null==(s=e.UNIT)?void 0:s.replace(/\d+/g,"").trim())||"PCS";t.some(e=>e.name===a)||t.push({name:a,decimal:3})}),t}function e7(e){let t=Object.entries(e);if(0===t.length)return{cgst:{percentage:"0%",amount:0},sgst:{percentage:"0%",amount:0}};let[s,a]=t[0];parseFloat(s);let l=t.map(e=>{let[t,s]=e;return s/2}).reduce((e,t)=>e+t,0);return{cgst:{percentage:"2.5%",amount:l},sgst:{percentage:"2.5%",amount:l}}}let e9=async()=>{eG(!0);try{let e=await fetch("https://finetic-ai-mobile.primedepthlabs.com/create-session",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to create session");let t=await e.json();console.log(t,"here is ression"),eM(t),te(t.sessionId)}catch(e){console.error("Error creating session:",e)}finally{eG(!1)}},te=e=>{let t=setInterval(async()=>{if(!e)return void clearInterval(t);try{let t=await fetch("https://finetic-ai-mobile.primedepthlabs.com/check-uploads/".concat(e));if(!t.ok)throw Error("Failed to check uploads");let{files:s}=await t.json();s.length>0&&eU(e=>{let t=new Set(e.map(e=>e.key)),a=s.filter(e=>!t.has(e.key));return a.length>0?(eV(e=>e+a.length),[...e,...a]):e})}catch(e){console.error("Error polling for files:",e)}},3e3);return()=>clearInterval(t)};console.log({billData:ei});let tt=async()=>{var e,t,s,a,l,r,n,i;let c="\n    <ENVELOPE>\n      <HEADER>\n        <VERSION>1</VERSION>\n        <TALLYREQUEST>Export</TALLYREQUEST>\n        <TYPE>Collection</TYPE>\n        <ID>Ledgers</ID>\n      </HEADER>\n      <BODY>\n        <DESC>\n          <STATICVARIABLES>\n            <SVEXPORTFORMAT>$$SysName:XML</SVEXPORTFORMAT>\n            <SVCURRENTCOMPANY>".concat(eD,'</SVCURRENTCOMPANY>\n          </STATICVARIABLES>\n          <TDL>\n            <TDLMESSAGE>\n              <COLLECTION ISMODIFY="No" ISFIXED="No" ISINITIALIZE="No" ISOPTION="No" ISINTERNAL="No" NAME="Ledgers">\n                <TYPE>Ledger</TYPE>\n                <NATIVEMETHOD>Address</NATIVEMETHOD>\n                <NATIVEMETHOD>Masterid</NATIVEMETHOD>\n                <NATIVEMETHOD>*</NATIVEMETHOD>\n              </COLLECTION>\n            </TDLMESSAGE>\n          </TDL>\n        </DESC>\n      </BODY>\n    </ENVELOPE>');if(ei&&ei.length>1)for(let l of ei){let r="Purchaser"===ea?null==(e=l.receiverDetails)?void 0:e.name:null==(t=l.senderDetails)?void 0:t.name,n="Purchaser"===ea?null==(s=l.receiverDetails)?void 0:s.gst:null==(a=l.senderDetails)?void 0:a.gst,i=l.items;e6(l.billDate);let d=e4(i),u=e8(i),m=e3(i),x=l.invoiceNumber,{cgst:h,sgst:g}=e7(eT),p={invoiceNumber:x,invoiceDate:"01-04-2025",companyName:"PrimeDepth Labs",partyName:r,purchaseLedger:"Purchase",items:m,gstNumber:"ABCDE1234F",isWithinState:!0,cgst:h,sgst:g},E=await (0,o.A3)(c,r,{name:r,parent:"Sundry Creditors",address:"",country:"India",state:"Punjab",date:"01-04-2025",gstin:n||"04AAACI7952A1ZZ"});if(console.log({name:r,parent:"Sundry Creditors",address:"",country:"India",state:"Punjab",date:"01-04-2025",gstin:n||"04AAACI7952A1ZZ"}),console.log({purchaserName:r,updatedUnits:u,updatedItemsForExport:d,purchaseVoucherPayload:p}),E.success)if((await (0,o.Df)(c,"Purchase")).success)if((await (0,o.BC)(c)).success)if((await (0,o.Dq)(u)).success)if((await (0,o.wE)(d)).success){let e=await (0,o.GH)(p);console.log({responsePurchaseVoucher:e}),e.success&&alert("Success: Voucher Created ")}else alert("Error: while creating Items");else alert("Error: while creating Unit");else alert("Error: while creating Tax Ledger");else alert("Error: while creating Purchase Ledger");else alert("Error: while creating Party Ledger")}else if(ei&&1===ei.length){let e=ei[0],t="Purchaser"===ea?null==(l=e.receiverDetails)?void 0:l.name:null==(r=e.senderDetails)?void 0:r.name,s="Purchaser"===ea?null==(n=e.receiverDetails)?void 0:n.gst:null==(i=e.senderDetails)?void 0:i.gst,a=e.items;e6(e.billDate);let d=e4(a),u=e8(a),m=e3(a),x=e.invoiceNumber,{cgst:h,sgst:g}=e7(eT),p={invoiceNumber:x,invoiceDate:"01-04-2025",companyName:"PrimeDepth Labs",partyName:t,purchaseLedger:"Purchase",items:m,gstNumber:"ABCDE1234F",isWithinState:!0,sgst:g,cgst:h};if(console.log({purchaserName:t},{updatedUnits:u},{updatedItemsForExport:d},{purchaseVoucherPayload:p},{updatedItemsForExport:d}),(await (0,o.A3)(c,t,{name:t,parent:"Sundry Creditors",address:"",country:"India",state:"Punjab",date:"01-04-2025",gstin:s||"04AAACI7952A1ZZ"})).success)if((await (0,o.Df)(c,"Purchase")).success)if((await (0,o.BC)(c)).success)if((await (0,o.Dq)(u)).success)if((await (0,o.wE)(d)).success){let e=await (0,o.GH)(p);console.log({responsePurchaseVoucher:e}),e.success&&alert("Success: Voucher Created ")}else alert("Error: while creating Items");else alert("Error: while creating Unit");else alert("Error: while creating Tax Ledger");else alert("Error: while creating Purchase Ledger");else alert("Error: while creating Party Ledger")}},ts=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ei,s=t[e].items||[],a=s.reduce((e,t)=>e+B(t.RATE*t.QTY),0),l={};s.forEach(e=>{let t=B(e.SGST),s=t+B(e.CGST)+B(e.IGST);if(!s)return;let a="".concat(s,"%"),r=B(e["NET AMT"])*(s/100);l[a]=(l[a]||0)+r}),ey(a),ej(l)};(0,l.useEffect)(()=>{tr(),tn()},[eD]),(0,l.useEffect)(()=>{!eD&&ev.length>0&&eI(ev[0])},[ev,eD]);let ta=e=>!e||e.length<2?null:e.substring(0,2),tl=(e,t)=>!e||!t||ta(e)===ta(t);(0,l.useEffect)(()=>{var e,t,s,a,l,r;if(ei.length>0&&(null==(t=ei[ec])||null==(e=t.items)?void 0:e.length)>0){let e=[...ei[ec].items],t=e.reduce((e,t)=>e+parseFloat(t.RATE)*parseFloat(t.QTY),0),n=tl(eR,"Purchaser"===ea?null==(a=ei[ec])||null==(s=a.senderDetails)?void 0:s.gst:null==(r=ei[ec])||null==(l=r.receiverDetails)?void 0:l.gst);eS(n);let i={};e.forEach(e=>{let t=parseFloat(e.GST)||0,s=parseFloat(e.RATE)*parseFloat(e.QTY),a=0,l=0,r=0;n?(a=t/2,l=t/2,e.SGST=a.toFixed(2),e.CGST=l.toFixed(2),e.IGST="0.00"):(e.IGST=t.toFixed(2),e.SGST="0.00",e.CGST="0.00");let o="".concat(t,"%"),c=t/100*s;console.log(e["NET AMT"],o,c,"here is the RATE"),i[o]||(i[o]=0),i[o]+=c}),ey(t),ej(i)}},[ei,ec]);let tr=async()=>{eg(!0);try{let e=await (0,o.gg)('<ENVELOPE>\n      <HEADER>\n        <VERSION>1</VERSION>\n        <TALLYREQUEST>Export</TALLYREQUEST>\n        <TYPE>Collection</TYPE>\n        <ID>List of Companies</ID>\n      </HEADER>\n      <BODY>\n        <DESC>\n          <STATICVARIABLES>\n            <SVIsSimpleCompany>No</SVIsSimpleCompany>\n          </STATICVARIABLES>\n          <TDL>\n            <TDLMESSAGE>\n              <COLLECTION ISMODIFY="No" ISFIXED="No" ISINITIALIZE="Yes" ISOPTION="No" ISINTERNAL="No" NAME="List of Companies">\n                <TYPE>Company</TYPE>\n                <NATIVEMETHOD>Name</NATIVEMETHOD>\n              </COLLECTION>\n              <ExportHeader>EmpId:5989</ExportHeader>\n            </TDLMESSAGE>\n          </TDL>\n        </DESC>\n      </BODY>\n    </ENVELOPE>');e.success?eA(e.data):console.error("Error fetching companies:",e.error)}catch(e){console.error("Error fetching companies:",e)}finally{eg(!1)}},tn=async()=>{let e="<ENVELOPE>\n    <HEADER>\n      <VERSION>1</VERSION>\n      <TALLYREQUEST>Export</TALLYREQUEST>\n      <TYPE>Collection</TYPE>\n      <ID>Ledgers</ID>\n    </HEADER>\n    <BODY>\n      <DESC>\n        <STATICVARIABLES>\n          <SVEXPORTFORMAT>$$SysName:XML</SVEXPORTFORMAT>\n          <SVCURRENTCOMPANY>".concat(eD,'</SVCURRENTCOMPANY>\n        </STATICVARIABLES>\n        <TDL>\n          <TDLMESSAGE>\n            <COLLECTION ISMODIFY="No" ISFIXED="No" ISINITIALIZE="No" ISOPTION="No" ISINTERNAL="No" NAME="Ledgers">\n              <TYPE>Ledger</TYPE>\n              <NATIVEMETHOD>Address</NATIVEMETHOD>\n              <NATIVEMETHOD>Masterid</NATIVEMETHOD>\n              <NATIVEMETHOD>*</NATIVEMETHOD>\n            </COLLECTION>\n          </TDLMESSAGE>\n        </TDL>\n      </DESC>\n    </BODY>\n  </ENVELOPE>');try{let t=await (0,o.FD)(e);console.log(t,"from gst api")}catch(e){console.error("Error fetching companies:",e)}finally{eg(!1)}};return((0,l.useEffect)(()=>{e9()},[]),0!==et||ea)?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 relative",children:[(0,a.jsx)(X,{isLoading:eh}),(0,a.jsx)("header",{className:"py-6 px-8 border-b border-gray-200 bg-white shadow-sm sticky top-0 z-20",children:(0,a.jsxs)("div",{className:"mx-auto flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("button",{onClick:()=>window.history.back(),className:"flex items-center text-gray-600 hover:text-blue-600 transition-colors",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 mr-1"}),(0,a.jsx)("span",{className:"font-medium",children:"Back"})]}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-800 hidden md:block",children:"Purchaser"===ea?"Purchase Bill Management":"Sales Bill Management"})]}),(0,a.jsx)("div",{className:"text-sm flex items-center gap-1 bg-blue-50 px-3 py-1.5 rounded-full",children:(0,a.jsx)("span",{className:"font-medium text-blue-700",children:"Purchaser"===ea?"Purchase Mode":"Sales Mode"})})]})}),(0,a.jsxs)("main",{className:"mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)(_,{steps:["Role Selection","Upload Files","Verify Data","Confirm"],currentStep:et}),1===et&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),ex(!0)},onDragLeave:()=>ex(!1),onDrop:eX,className:"group relative bg-white rounded-2xl border-2 border-dashed ".concat(em?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-300"," transition-all duration-200 py-16 px-6 text-center cursor-pointer shadow-lg hover:shadow-xl"),onClick:()=>{var e;return null==(e=eu.current)?void 0:e.click()},children:[(0,a.jsx)("div",{className:"space-y-6 relative z-10",children:(0,a.jsxs)("div",{className:"inline-flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-4 group-hover:bg-blue-100 transition-colors duration-200 group-hover:scale-110 transform",children:(0,a.jsx)(g.A,{className:"w-8 h-8 text-blue-600"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-2xl md:text-3xl font-bold text-gray-800 group-hover:text-blue-700 transition-colors",children:"Drag & Drop Bills"}),(0,a.jsxs)("p",{className:"text-gray-500 max-w-md mx-auto",children:["Supported formats: JPG, PDF (Max ",50,"MB each)"]}),(0,a.jsx)("button",{className:"inline-flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded-lg shadow-md hover:shadow-lg transition-all mx-auto",children:(0,a.jsx)("span",{children:"Browse Files"})})]})]})}),(0,a.jsx)("input",{type:"file",ref:eu,multiple:!0,accept:".jpg,.jpeg,.pdf,image/jpeg,application/pdf",onChange:ez,className:"hidden"}),(0,a.jsxs)("div",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",children:[(0,a.jsx)("div",{className:"absolute top-6 left-6 w-16 h-16 bg-blue-100 rounded-full opacity-20"}),(0,a.jsx)("div",{className:"absolute bottom-6 right-6 w-20 h-20 bg-blue-100 rounded-full opacity-20"})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Scan Bills with Your Phone"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Scan this QR code with your phone's camera to upload bills directly from your mobile device"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:eO?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-green-600 mb-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 mr-1"}),"Mobile session active"]}),eF>0&&(0,a.jsxs)("div",{className:"w-full text-sm text-blue-600",children:[eF," ",1===eF?"file":"files"," received from mobile"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500 italic mb-2 flex items-center",children:[(0,a.jsx)(E.A,{className:"w-4 h-4 mr-1 text-amber-500"}),"No active session"]}),(0,a.jsxs)("button",{onClick:e9,className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"w-4 h-4"}),"Start Mobile Session"]})]})})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-white p-3 rounded-xl border border-blue-100 relative",children:[ek&&(0,a.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center rounded-xl",children:(0,a.jsx)("div",{className:"w-8 h-8 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}),eO?(0,a.jsx)(U.Ay,{value:eO.mobileUploadUrl,size:180,bgColor:"#FFFFFF",fgColor:"#1D4ED8",style:{height:180,maxWidth:"100%",width:"100%"}}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",style:{height:180,width:180},children:(0,a.jsx)(f.A,{className:"w-16 h-16 text-gray-300"})})]})]})}),(er.length>0||eY.length>0)&&(0,a.jsxs)("div",{className:"space-y-4 bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"w-5 h-5 text-blue-600"}),"Uploaded Files (",er.length+eY.length,")"]}),(er.length>1||eY.length>0)&&(0,a.jsxs)("button",{onClick:()=>{en([]),eU([])},className:"text-red-500 hover:text-red-700 text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)(y.A,{className:"w-4 h-4"}),"Clear All"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[er.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 flex items-center shadow-md hover:shadow-lg transition-shadow border border-gray-100",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,a.jsx)(N.A,{className:"text-blue-600 w-6 h-6"})}),(0,a.jsxs)("div",{className:"ml-4 flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-gray-800 truncate",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]})]}),(0,a.jsx)("button",{onClick:async t=>{t.stopPropagation(),await e1(e.id)},className:"text-gray-400 hover:text-red-600 ml-4 transition-colors rounded-full p-1.5 hover:bg-red-50",children:(0,a.jsx)(c.A,{className:"w-5 h-5"})})]},e.id)),eY.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 flex items-start gap-4 shadow-md hover:shadow-lg transition-shadow border border-gray-100 border-l-4 border-l-blue-500",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,a.jsx)(f.A,{className:"text-blue-600 w-6 h-6"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-gray-800 truncate",children:e.key.split("/").pop()}),(0,a.jsx)("p",{className:"text-sm text-gray-500 flex items-center gap-1 mb-2",children:(0,a.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded",children:"Mobile Upload"})}),e.url.endsWith(".pdf")?(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"View PDF"}):(0,a.jsx)("img",{src:e.url,alt:"Uploaded Preview",className:"rounded-lg border border-gray-200 max-w-xs max-h-40 object-contain"})]}),(0,a.jsx)("button",{onClick:async t=>{t.stopPropagation(),console.log(t,e,eO),await r.A.delete("https://finetic-ai-mobile.primedepthlabs.com/delete-upload/".concat(null==eO?void 0:eO.sessionId),{data:{key:e.key},headers:{"Content-Type":"application/json"}}),eU(t=>t.filter(t=>t.key!==e.key))},className:"text-gray-400 hover:text-red-600 ml-4 transition-colors rounded-full p-1.5 hover:bg-red-50",children:(0,a.jsx)(c.A,{className:"w-5 h-5"})})]},e.key))]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-6",children:(0,a.jsxs)("button",{onClick:eZ,disabled:0===er.length&&0===eY.length,className:"px-6 py-3 rounded-lg font-medium text-base transition-all flex items-center gap-2 ".concat(er.length>0||eY.length>0?"bg-blue-600 text-white hover:bg-blue-700 shadow-lg hover:shadow-xl":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:["Process Files",(0,a.jsx)(T.A,{className:"w-5 h-5"})]})})]}),2===et&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white p-6 shadow-lg rounded-xl mb-6",children:(0,a.jsx)("div",{className:"gap-6",children:(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsxs)("div",{className:"w-1/2",children:[(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg overflow-hidden flex items-center justify-center",style:{height:"30rem"},children:(null==(t=er[ec])||null==(e=t.dataUrl)?void 0:e.includes("image/"))?(0,a.jsx)(z,{src:er[ec].dataUrl,alt:"Bill ".concat(ec+1),style:{width:"100%",height:"100%"}}):(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)(N.A,{className:"w-16 h-16 mx-auto mb-4"}),(0,a.jsx)("p",{children:"PDF Preview Not Available"})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsx)("button",{onClick:()=>e5(Math.max(0,ec-1)),disabled:0===ec,className:"flex items-center justify-center p-2 rounded-full ".concat(0===ec?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:text-blue-600 hover:bg-blue-50"," transition-colors"),children:(0,a.jsx)(j.A,{className:"w-5 h-5"})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:er.map((e,t)=>(0,a.jsx)("button",{onClick:()=>e5(t),className:"w-2.5 h-2.5 rounded-full transition-all ".concat(ec===t?"bg-blue-600 w-6":"bg-gray-300 hover:bg-gray-400"),"aria-label":"Go to bill ".concat(t+1)},t))}),(0,a.jsx)("button",{onClick:()=>{ec===er.length-1?es(3):e5(ec+1)},className:"flex items-center justify-center p-2 rounded-full text-gray-600 hover:text-blue-600 hover:bg-blue-50 transition-colors",children:(0,a.jsx)(T.A,{className:"w-5 h-5"})})]})]}),(0,a.jsx)("div",{className:"w-1/2",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-5 h-5"}),"Bill Information"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsx)(Z,{label:"Invoice Number",value:(null==(s=ei[ec])?void 0:s.invoiceNumber)||"",onChange:e=>eq("invoiceNumber",e.target.value)}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 flex items-center gap-1.5",children:[(0,a.jsx)(A.A,{className:"w-4 h-4"}),"Bill Date"]}),(0,a.jsx)("input",{type:"text",value:(null==(i=ei[ec])?void 0:i.billDate)||"",onChange:e=>eq("billDate",e.target.value),className:"block w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all bg-white hover:bg-gray-50 focus:bg-white",placeholder:"DD/MM/YYYY"})]})]}),(0,a.jsxs)("div",{className:"pt-2 space-y-6",children:[(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2 mb-4",children:[(0,a.jsx)(w.A,{className:"w-5 h-5"}),"Sender Details"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsx)(Z,{label:"Sender Name",value:null==ei||null==(d=ei[ec])?void 0:d.senderDetails.name,onChange:e=>eq("senderDetails",{...senderDetails,name:e.target.value})}),(0,a.jsx)(Z,{label:"Sender GST",value:null==ei||null==(x=ei[ec])?void 0:x.senderDetails.gst,onChange:e=>eq("senderDetails",{...senderDetails,gst:e.target.value})})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2 mb-4",children:[(0,a.jsx)(w.A,{className:"w-5 h-5"}),"Receiver Details"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsx)(Z,{label:"Receiver Name",value:null==ei||null==(C=ei[ec])?void 0:C.receiverDetails.name,onChange:e=>eq("receiverDetails",{...receiverDetails,name:e.target.value})}),(0,a.jsx)(Z,{label:"Receiver GST",value:null==ei||null==(P=ei[ec])?void 0:P.receiverDetails.gst,onChange:e=>eq("receiverDetails",{...receiverDetails,gst:e.target.value})})]})]})]})]})})]})})}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(S.A,{className:"w-5 h-5"}),"Item Details"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>eW(ec),className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors shadow-sm",children:[(0,a.jsx)(D.A,{className:"w-4 h-4 mr-1.5"}),"Add Item"]}),(0,a.jsxs)("button",{onClick:()=>{var e;let t=ei[ec];if(!t||!(null==(e=t.items)?void 0:e.length))return void L.oR.warn("No items to export in this bill");let s=t.items.map(e=>({Product:e.Product,Quantity:e.QTY,HSN:e.HSN,MRP:e.MRP,Rate:e.RATE,Discount:e.DIS,SGST:e.SGST,CGST:e.CGST,IGST:e.IGST,"Gross Amt":e["G AMT"],"Net Amt":e["NET AMT"],Unit:e.UNIT})),a=F.Wp.json_to_sheet(s),l="InvoiceItems-".concat(t.invoiceNumber||ec+1,".xlsx");F._h({Sheets:{Items:a},SheetNames:["Items"]},l),L.oR.success("Exported ".concat(s.length," items → ").concat(l))},className:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700",children:[(0,a.jsx)(N.A,{className:"w-4 h-4 mr-1.5"}),"Export to Excel"]})]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsx)("tr",{children:["Product","QTY","HSN","MRP","RATE","DIS",...ew?["SGST","CGST"]:["IGST"],"G AMT","Actions"].map(e=>(0,a.jsx)("th",{className:"px-3 py-3.5 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:e},e))})}),(0,a.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[null==(M=ei[ec])||null==(O=M.items)?void 0:O.map((e,t)=>{var s;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("tr",{className:"transition-colors mt-10 ".concat(0==e.Qty||0==e.RATE?"bg-red-300":""),children:[(0,a.jsx)("td",{className:"px-3 py-2.5 w-72 relative",draggable:!0,onDragStart:e=>eK(e,ec,t),onDragOver:e0,onDrop:e=>e2(e,ec,t),children:(0,a.jsxs)("div",{className:"flex items-center group",children:[(0,a.jsx)(I.A,{className:"w-4 h-4 text-gray-400 mr-2 opacity-0 group-hover:opacity-100 transition-opacity cursor-grab"}),(0,a.jsx)("input",{type:"text",value:e.Product||"",onChange:e=>eJ(ec,t,"Product",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,a.jsx)("td",{className:"px-3 py-2 w-20",children:(0,a.jsx)("input",{type:"text",value:e.QTY||"",onChange:e=>eJ(ec,t,"QTY",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("td",{className:"px-3 py-2 w-28",children:(0,a.jsx)("input",{type:"text",value:e.HSN||"",onChange:e=>eJ(ec,t,"HSN",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("td",{className:"px-3 py-2 w-28",children:(0,a.jsx)("input",{type:"number",value:e.MRP||"",onChange:e=>eJ(ec,t,"MRP",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("td",{className:"px-3 py-2 w-28",children:(0,a.jsx)("input",{type:"number",value:e.RATE||"",onChange:e=>eJ(ec,t,"RATE",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("td",{className:"px-3 py-2 w-24",children:(0,a.jsx)("input",{type:"text",value:e.DIS||"",onChange:e=>eJ(ec,t,"DIS",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)(a.Fragment,{children:ew?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("td",{className:"px-3 py-2 w-16",children:(0,a.jsx)("input",{type:"text",value:e.SGST||"",onChange:e=>eJ(ec,t,"SGST",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("td",{className:"px-3 py-2 w-16",children:(0,a.jsx)("input",{type:"text",value:e.CGST||"",onChange:e=>eJ(ec,t,"CGST",e.target.value),className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})})]}):(0,a.jsx)("td",{className:"px-3 py-2 w-32",children:(0,a.jsx)("input",{type:"text",value:parseFloat(e.IGST||0),onChange:e=>{eJ(ec,t,"IGST",e.target.value)},className:"w-full border border-gray-300 rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500"})})}),(0,a.jsx)("td",{className:"px-3 py-2 w-28",children:(0,a.jsx)("p",{className:"w-full rounded-md p-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500",children:e["G AMT"]})}),(0,a.jsx)("td",{className:"px-3 py-2 w-10",children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("button",{onClick:()=>e$(ec,t),className:"text-red-500 hover:text-red-700 p-1.5 hover:bg-red-50 rounded transition-colors",title:"Remove item",children:(0,a.jsx)(y.A,{className:"w-4 h-4"})})})})]},t),(0,a.jsx)("tr",{className:"pb-10",children:(0,a.jsx)("td",{className:"px-3 py-2.5 text-center border-b-8 border-gray-300 ".concat(0==e.Qty||0==e.RATE?"bg-red-300":""),colSpan:11,children:(0,a.jsx)("div",{className:"gap-2 mx-auto w-[fit-content]",children:null==(s=ei[ec].invoice_items_cropped_images)?void 0:s.cell_images.filter((e,s)=>0===s||s===t+1||s===t+2).map((e,t)=>(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map((e,s)=>e?(0,a.jsx)("img",{src:e,alt:"Invoice cell ".concat(t,"-").concat(s),onClick:()=>eP(e),className:"w-[90px] h-[30px] object-contain border-2 rounded cursor-zoom-in hover:border-blue-500 transition-colors"},s):(0,a.jsx)("div",{className:"w-[100px] h-[100px] border flex items-center justify-center text-xs text-gray-500",children:"No Image"},s))},t))})})})]})}),(!(null==(k=ei[ec])?void 0:k.items)||(null==(Y=ei[ec])?void 0:Y.items.length)===0)&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:12,className:"px-6 py-8 text-center text-gray-500",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("svg",{className:"w-12 h-12 text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,a.jsx)("p",{className:"mb-2",children:"No items found in this bill"}),(0,a.jsxs)("button",{onClick:()=>eW(ec),className:"text-blue-600 hover:text-blue-800 font-medium flex items-center",children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-1"}),"Add an item"]})]})})})]})]})})]}),(0,a.jsx)(()=>{let e=Object.values(eT).reduce((e,t)=>e+t,0);return console.log({gstTotals:eT}),(0,a.jsxs)("div",{className:"mt-6 bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Bill Totals"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"GST Breakup"}),0===Object.keys(eT).length?(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No GST data available"}):(0,a.jsxs)("div",{className:"space-y-2",children:[Object.entries(eT).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"font-medium",children:[t," GST"]}),(0,a.jsx)("span",{className:"text-gray-500 ml-2",children:ew?"CGST: ".concat(parseFloat(t)/2,"%, SGST: ").concat(parseFloat(t)/2,"%"):"IGST: ".concat(t,"%")})]}),(0,a.jsxs)("span",{className:"font-medium text-black",children:["₹",s.toFixed(2)]})]},t)}),(0,a.jsxs)("div",{className:"pt-2 mt-2 border-t border-gray-200 flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium text-black",children:"Total GST Amount"}),(0,a.jsxs)("span",{className:"font-bold text-black",children:["₹",e.toFixed(2)]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-600 mb-3",children:"Bill Summary"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Taxable Amount"}),(0,a.jsxs)("span",{className:"font-medium text-black",children:["₹",eN.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsx)("span",{className:"text-gray-700",children:"Total GST"}),(0,a.jsxs)("span",{className:"font-medium  text-black",children:["₹",e.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"pt-2 mt-2 border-t border-gray-200 flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium text-black",children:"Gross Amount Total"}),(0,a.jsxs)("span",{className:"text-xl font-bold text-blue-700",children:["₹",(eN+e).toFixed(2)]})]})]})]})]})]})},{}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Financial Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Total Amount"}),(0,a.jsx)("input",{type:"number",value:(null==(Q=ei[ec])?void 0:Q.totalAmount)||"",onChange:e=>eq("totalAmount",e.target.value),className:"block w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all bg-white hover:bg-gray-50 focus:bg-white"})]}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Grand Total"}),(0,a.jsx)("input",{type:"text",value:(null==(q=ei[ec])?void 0:q.grandTotal)||"",onChange:e=>eq("grandTotal",e.target.value),className:"block w-full border border-gray-300 rounded-lg p-3 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all bg-white hover:bg-gray-50 focus:bg-white font-medium"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,a.jsxs)("button",{onClick:()=>es(1),className:"px-5 py-2.5 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition flex items-center gap-2 shadow-sm",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),"Back to Files"]}),(0,a.jsxs)("button",{onClick:()=>{ec===er.length-1?es(3):e5(ec+1)},className:"px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 shadow-md",children:[ec===er.length-1?"Proceed to Confirm":"Next Bill",(0,a.jsx)(T.A,{className:"w-4 h-4"})]})]})]}),3===et&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Bill Summary"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:er.map((e,t)=>{var s,l,r,n,i,o,c,d,u;return(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"aspect-square bg-gray-50 overflow-hidden relative",children:[e.dataUrl.includes("image/")?(0,a.jsx)("img",{src:e.dataUrl,alt:"Bill ".concat(t+1),className:"object-cover w-full h-full"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,a.jsx)(N.A,{className:"w-16 h-16"})}),(0,a.jsxs)("div",{className:"absolute top-3 right-3 bg-black/60 text-white text-xs px-3 py-1 rounded-full",children:["Bill #",t+1]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:(null==(s=ei[t])?void 0:s.billDate)||"No date specified"}),(0,a.jsx)("p",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded",children:(null==(l=ei[t])?void 0:l.invoiceNumber)||"No invoice #"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-800",children:["₹",(null==(r=ei[t])?void 0:r.totalAmount)||"0.00"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 truncate",children:"Purchaser"===ea?"From: ".concat((null==(i=ei[t])||null==(n=i.senderDetails)?void 0:n.name)||"Unknown"):"To: ".concat((null==(c=ei[t])||null==(o=c.receiverDetails)?void 0:o.name)||"Unknown")}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[(null==(u=ei[t])||null==(d=u.items)?void 0:d.length)||0," items"]})]}),(0,a.jsxs)("button",{onClick:()=>{ed(t),es(2)},className:"mt-4 w-full text-sm text-blue-600 hover:text-blue-800 flex items-center justify-center gap-1.5 font-medium py-1.5 border-t border-gray-100",children:[(0,a.jsx)(R.A,{className:"w-3.5 h-3.5"}),"Edit Details"]})]})]},e.id)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-50 rounded-full mb-4",children:(0,a.jsx)(m.A,{className:"w-8 h-8 text-blue-600"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Ready to Export"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2 max-w-md mx-auto",children:"All bills have been processed and are ready to be exported to your accounting system."})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-center mt-8",children:[(0,a.jsxs)("button",{onClick:()=>es(2),className:"px-6 py-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200 transition flex items-center justify-center gap-2 shadow border border-gray-200",children:[(0,a.jsx)(j.A,{className:"w-5 h-5"}),"Review Bills Again"]}),(0,a.jsxs)("button",{onClick:tt,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2 shadow-lg",children:[(0,a.jsx)(m.A,{className:"w-5 h-5"}),"Export Data to Tally"]})]}),(0,a.jsx)("div",{className:"border-t border-gray-100 mt-8 pt-6",children:(0,a.jsxs)("p",{className:"text-center text-gray-500 text-sm",children:[ep,eb&&(0,a.jsx)("span",{className:"block text-red-500 mt-2",children:eb})]})})]})]})]}),(0,a.jsx)(H,{open:null!==K,rowIndex:null!=K?K:0,item:null!==K?null==(J=ei[ec])?void 0:J.items[K]:{},images:null!==K?(null!=($=null==(W=ei[ec].invoice_items_cropped_images)?void 0:W.cell_images)?$:[]).filter((e,t)=>0===t||t===K+1||t===K+2).flat().filter(Boolean):[],onUpdate:(e,t)=>null!==K&&eJ(ec,K,e,t),onClose:()=>ee(null)}),eC&&(0,a.jsxs)("div",{className:"fixed inset-0 z-[90] bg-black/70 backdrop-blur-sm flex items-center justify-center",onClick:()=>eP(null),children:[(0,a.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,a.jsx)(z,{src:eC,alt:"Zoom preview",style:{width:"85vw",height:"85vh"}})}),(0,a.jsx)("button",{onClick:()=>eP(null),className:"absolute top-5 right-5 text-white/80 hover:text-white bg-black/50 backdrop-blur rounded-full p-2",children:(0,a.jsx)(c.A,{className:"w-6 h-6"})})]})]}):(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,a.jsx)("header",{className:"py-6 px-8 border-b border-gray-200 bg-white shadow-sm",children:(0,a.jsxs)("div",{className:"mx-auto flex items-center",children:[(0,a.jsxs)("button",{onClick:()=>window.history.back(),className:"flex items-center text-gray-600 hover:text-blue-600 transition-colors",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 mr-1"}),(0,a.jsx)("span",{className:"font-medium",children:"Back"})]}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 ml-6",children:"Bill Management System"})]})}),(0,a.jsx)("main",{className:"flex-1 flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"w-full max-w-4xl bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:0===et?"Select Company":"Select Document Type"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:0===et?"Choose the company you want to work with":"Choose the type of bills you want to manage"})]}),0===et?(0,a.jsx)("div",{className:"p-8 space-y-6",children:eh?(0,a.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-700",children:"Select Company"}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("select",{id:"company",value:eD,onChange:e=>eI(e.target.value),className:"block w-full pl-3 pr-10 py-3 text-black border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border-2",children:[0===ev.length&&(0,a.jsx)("option",{value:"",children:"No companies available"}),ev&&(null==ev?void 0:ev.map((e,t)=>(0,a.jsx)("option",{value:e,children:e},t)))]})})]})})}):(0,a.jsxs)("div",{className:"p-8 space-y-6",children:[(0,a.jsx)("div",{className:"mb-4 pb-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Selected Company:"}),(0,a.jsx)("span",{className:"ml-2 text-sm font-semibold text-gray-900",children:eD}),(0,a.jsx)("button",{onClick:()=>es(0),className:"ml-3 text-sm text-blue-600 hover:text-blue-800",children:"Change"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,a.jsxs)("button",{onClick:()=>{el("Purchaser")},className:"group relative flex flex-col items-center p-8 border border-gray-200 rounded-xl hover:border-blue-500 hover:shadow-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-5 group-hover:bg-blue-200 transition-colors duration-200 relative z-10",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-1 relative z-10",children:"Purchase Bills"}),(0,a.jsx)("p",{className:"text-gray-500 text-center mx-auto max-w-xs relative z-10",children:"Enter and manage bills for items or services you've purchased"}),(0,a.jsx)("div",{className:"mt-6 bg-blue-500 text-white px-5 py-2 rounded-full font-medium text-sm relative z-10 opacity-0 group-hover:opacity-100 transform translate-y-2 group-hover:translate-y-0 transition-all duration-200",children:"Select"})]}),(0,a.jsxs)("button",{onClick:()=>{el("Seller")},className:"group relative flex flex-col items-center p-8 border border-gray-200 rounded-xl hover:border-green-500 hover:shadow-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-green-50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-5 group-hover:bg-green-200 transition-colors duration-200 relative z-10",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-1 relative z-10",children:"Sales Bills"}),(0,a.jsx)("p",{className:"text-gray-500 text-center mx-auto max-w-xs relative z-10",children:"Create and manage bills for products or services you've sold"}),(0,a.jsx)("div",{className:"mt-6 bg-green-500 text-white px-5 py-2 rounded-full font-medium text-sm relative z-10 opacity-0 group-hover:opacity-100 transform translate-y-2 group-hover:translate-y-0 transition-all duration-200",children:"Select"})]})]})]}),(0,a.jsx)("div",{className:"mb-6 px-8 text-black",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"gstNumber",className:"block text-sm font-medium text-black",children:"GST Number"}),(0,a.jsx)("input",{type:"text",id:"gstNumber",value:eR,onChange:e=>eL(e.target.value),placeholder:"Enter GST Number",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),(0,a.jsx)("div",{className:"flex justify-end my-6 px-4",children:(0,a.jsx)("button",{onClick:()=>es(1),disabled:!eD,className:"px-6 py-2 rounded-md text-white font-medium transition-all \n                        ".concat(eD?"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-300 cursor-not-allowed"),children:"Continue"})})]})})]})}},7058:(e,t,s)=>{"use strict";s.d(t,{$o:()=>a,AT:()=>l});let a="https://finetic-ai.primedepthlabs.com",l=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"application/json",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"json";try{let n,i={"Content-Type":l,...a},o={method:t,headers:i},c="http://localhost:9000"+e;console.log("Making request to:",c),s&&"GET"!==t&&(l.includes("xml")?o.body="string"==typeof s?s:s.toString():l.includes("json")&&"string"!=typeof s?o.body=JSON.stringify(s):o.body=s);let d=await fetch(c,o);if(!d.ok){let e=await d.text();throw Error("Error from API request: ".concat(d.status," ").concat(d.statusText,"\n").concat(e))}switch(r.toLowerCase()){case"json":default:n=await d.json();break;case"text":case"xml":n=await d.text()}return n}catch(t){throw console.error("API Error for",e,":",t),t}}},9744:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});let a=(0,s(6879).UU)("https://ygmjdexujknxnpyqxjzi.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlnbWpkZXh1amtueG5weXF4anppIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczODE3ODI3NSwiZXhwIjoyMDUzNzU0Mjc1fQ.buox9zYTmt3OOWpXHwLTiagqNLpeyw3KuqE2zJBwDx4")}}]);